<h1>CPE 400 Project Web Interface</h1>
<h3>By Amir Behmaram, Austyn Herman, and Tyler Frasca</h3>

<br>
<h4>Arduinos</h4>
<div>
  <% @arduinos.each do |arduino| %>
    <div>Arduino <%= arduino.id %> <%= arduino.id == 1 ? '(Master)' : nil %> Status:
      <span style="color:<%= arduino.status == true ? 'green' : arduino.status == nil ? 'blue' : 'red' %>">
        <%= arduino.status == true ? 'Connected' : arduino.status == nil ? 'Waiting...' : 'Disconnected' %>
      </span>
    </div>
    <button onClick="connect_arduino(<%= arduino.id %>)">Connect Arduino <%= arduino.id %> <%= arduino.id == 1 ? '(Master)' : nil %></button>
    <button onClick="reset_arduino(<%= arduino.id %>)">Reset Arduino <%= arduino.id %> <%= arduino.id == 1 ? '(Master)' : nil %></button>
    <button onClick="error_arduino(<%= arduino.id %>)">Error Arduino <%= arduino.id %> <%= arduino.id == 1 ? '(Master)' : nil %></button>
    <br><br>
  <% end %>
</div>

<br>
<h4>Magnetic Sensors</h4>
<div>
  <% @magnetic_sensors.each do |magnetic_sensor| %>
    <div>Magnetic Sensor <%= magnetic_sensor.id %> Status:
      <span style="color:<%= magnetic_sensor.status == true ? 'green' : magnetic_sensor.status == nil ? 'blue' : 'red' %>">
        <%= magnetic_sensor.status == true ? 'Connected' : magnetic_sensor.status == nil ? 'Waiting...' : 'Disconnected' %>
      </span>
    </div>
    <button onClick="connect_magnetic_sensor(<%= magnetic_sensor.id %>)">Connect Magnetic Sensor <%= magnetic_sensor.id %> </button>
    <button onClick="reset_magnetic_sensor(<%= magnetic_sensor.id %>)">Reset Magnetic Sensor <%= magnetic_sensor.id %> </button>
    <button onClick="error_magnetic_sensor(<%= magnetic_sensor.id %>)">Error Magnetic Sensor <%= magnetic_sensor.id %> </button>
    <br><br>
  <% end %>
</div>

<br>
<h4>Intrusions</h4>
<div>
  <% @intrusions.each do |intrusion| %>
    <div><span style="color: red">Intrusion</span> at
      <%= intrusion.created_at.strftime("%A %B %e, %Y at %l:%M %p") %>
    </div>
  <% end %>
</div>

<br>
<div>
  <h4>Photos</h4><br>
  <% @photos.each do |photo| %>
    <image src='<%= photo.image %>'>
  <% end %>
</div>

<script>
  var connect_arduino = function(id) {
    $.post('/connect_arduino', {
      id: id
    })
  }

  var reset_arduino = function(id) {
    $.post('/reset_arduino', {
      id: id
    })
  }

  var error_arduino = function(id) {
    $.post('/error_arduino', {
      id: id
    })
  }

  var connect_magnetic_sensor = function(id) {
    $.post('/connect_magnetic_sensor', {
      id: id
    })
  }

  var reset_magnetic_sensor = function(id) {
    $.post('/reset_magnetic_sensor', {
      id: id
    })
  }

  var error_magnetic_sensor = function(id) {
    $.post('/error_magnetic_sensor', {
      id: id
    })
  }

  var removePhotos = function() {
    $.get('/remove_photos');
  }
</script>
